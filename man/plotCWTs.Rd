% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plotCWTs.R
\name{plotCWTs}
\alias{plotCWTs}
\title{Continuous wavelet transform (CWT)}
\usage{
plotCWTs(
  data,
  variable,
  plot.title = paste("Wavelet Power Spectrum -", tools::toTitleCase(variable)),
  id.col = getDefaults("ID"),
  timebin.col = getDefaults("timebin"),
  id.groups = NULL,
  wavelet.type = "MORLET",
  gap.handling = "zero",
  same.scale = FALSE,
  mask.coi = FALSE,
  period.range = c(3, 48),
  axis.periods = c(6, 12, 16, 24, 48),
  time.unit = "hours",
  color.pal = NULL,
  min.days = NULL,
  detrend.method = "none",
  loess.span = 0.75,
  standardize = FALSE,
  date.format = "\%d/\%b",
  date.interval = 4,
  date.start = 1,
  cex.main = 1.2,
  cex.lab = 1.1,
  cex.axis = 1,
  cex.legend = 0.9,
  legend.xpos = c(0.895, 0.91),
  legend.ypos = c(0.15, 0.85),
  cols = 1,
  par.args = list(),
  cores = 1,
  ...
)
}
\arguments{
\item{data}{A data frame containing binned animal detections or other time-based measurements.
The time series does not need to be regular; gaps between time bins are allowed.
If there are gaps between measurements (i.e., missing time bins), the handling method is
controlled by the \code{gap.handling} parameter.}

\item{variable}{Name of the column containing the numeric variable to be analyzed.}

\item{plot.title}{A string specifying the title of the plot. By default, this title is
automatically generated as "Wavelet Power Spectrum" followed by the \code{variable} name.}

\item{id.col}{Name of the column containing animal IDs. Defaults to 'ID'.}

\item{timebin.col}{Name of the column containing time bins (in POSIXct format). Defaults to 'timebin'.}

\item{id.groups}{Optional. A list containing ID groups, used to
visually aggregate animals belonging to the same class (e.g. different species).}

\item{wavelet.type}{A character string specifying the wavelet type to be used in the continuous wavelet transform.
This is passed to the \code{wname} argument in the \code{\link[wavScalogram]{cwt_wst}} function.
Possible values are: "MORLET", "DOG", "PAUL", "HAAR", or "HAAR2". The default is "MORLET".}

\item{gap.handling}{Method for handling missing time bins in the time series. Options are:
\itemize{
\item "zero" (default): Fill gaps with zeros (appropriate for detection/count data)
\item "mean": Fill gaps with the mean of the non-missing values for that individual
\item "locf": Last observation carried forward (use the last valid observation)
\item "interpolate": Linear interpolation between valid observations (recommended for environmental data)
}}

\item{same.scale}{Forces same spectral scale (zlims) across all plots,
allowing for density comparison between individuals.}

\item{mask.coi}{Logical. If TRUE, regions outside the cone of influence (COI)
are excluded from color scale calculations and plotted in black. This prevents
edge effects from dominating the color scale. Defaults to FALSE.}

\item{period.range}{The range of period scales (y-axis limits) to be considered,
specified in the units defined by \code{time.unit}. Defaults to c(3, 48) in hours.}

\item{axis.periods}{Periods to include/highlight on the y-axis, specified in the units
defined by \code{time.unit}. Defaults to c(6,12,16,24,48) in hours.}

\item{time.unit}{Time unit for \code{period.range} and \code{axis.periods}.
Options are "mins", "hours" and "days". Defaults to "hours".}

\item{color.pal}{Color palette. Defaults to the Jet colormap.}

\item{min.days}{Discard individuals that were detected in less than x days.}

\item{detrend.method}{Method for detrending the time series prior to CWT analysis.
Options are:
\itemize{
\item "none" (default): No detrending is applied.
\item "diff": Applies first-order differencing (\code{\link[base]{diff}}) to remove
linear trends. Note that this analyzes the \emph{rate of change} of the signal.
\item "loess": Fits a LOESS regression (using \code{\link[stats]{loess}}) and
performs the CWT on the residuals. This is effective for removing complex,
non-linear trends. The smoothness is controlled by \code{loess.span}.
}}

\item{loess.span}{The span (alpha) parameter for LOESS detrending, used only if
\code{detrend.method = "loess"}. Controls the degree of smoothing; larger values
fit a smoother, less "wiggly" trend line. Defaults to 0.75.}

\item{standardize}{Logical. If TRUE, the time series for each individual is
standardized to have a mean of 0 and a standard deviation of 1 (i.e.,
Z-scored using \code{\link[base]{scale}}) prior to CWT analysis.
This is applied \emph{after} detrending. This can help reveal periodicities
in signals with low amplitude relative to their mean. Defaults to FALSE.}

\item{date.format}{Date-time format (as used in \code{\link[base]{strptime}}),
defining the x-axis labels. Defaults to month ("\%d/\%b").}

\item{date.interval}{Number defining the interval between each
displayed date (x-axis label). Defaults to 4.}

\item{date.start}{Integer defining the first displayed date (can be used in combination
with 'date.interval" to better control the x-axis labels). Defaults to 1.}

\item{cex.main}{Determines the size of the title(s). Defaults to 1.2.}

\item{cex.lab}{Determines the size of the y-axis and y-axis labels. Defaults to 1.1.}

\item{cex.axis}{Determines the size of the text labels on the axes. Defaults to 1.}

\item{cex.legend}{Determines the size of the text labels on the color legend. Defaults to 0.9.}

\item{legend.xpos}{Relative position of left and right edge of color bar on first axis (0-1).
Defaults to c(0.90, 0.915).}

\item{legend.ypos}{Relative position of left and right edge of color bar on second axis (0-1).
Defaults to c(0.15, 0.85).}

\item{cols}{Number of columns to arrange plots in when multiple individuals are displayed.
Ignored if \code{par.args$mfrow} is provided, in which case the layout is controlled
entirely by the user via \code{par.args}.}

\item{par.args}{Optional named list of graphical parameters to pass to \code{\link[graphics:par]{graphics::par()}}.
This allows fine control over the multi-panel layout and plot spacing.
Any arguments supplied here will override the internal defaults used by the function
(such as \code{mfrow}, \code{mar}, \code{oma}, or \code{mgp}).
For example, to reduce margins and adjust outer spacing:
\preformatted{
par.args = list(
   mar = c(3, 4, 2, 1),
   oma = c(1, 1, 2, 1)
)
}
By default, an empty list (\code{list()}) is used, which applies the function's built-in layout settings.}

\item{cores}{Number of CPU cores to use for the computations. Defaults to 1, which
means no parallel computing (single core).  If set to a value greater than 1,
the function will use parallel computing to speed up calculations.
Run \code{parallel::detectCores()} to check the number of available cores.}

\item{...}{Further arguments passed to the \code{\link[wavScalogram]{cwt_wst}} function.
(e.g. border_effects, waverad).}
}
\description{
Function that analyzes and plots periodic patterns in a time series using a
Continuous Wavelet Transform (CWT) framework. CWT analysis provides an alternative method
to the Fast Fourier Transform (FFT) or other time-frequency decomposition techniques,
enabling the examination of periodicities over time. This function serves mostly as a
wrapper for the \code{\link[wavScalogram]{cwt_wst}} function from the \code{wavScalogram} package
(Bolos & Benitez, 2022).
}
\references{
Bolos, V. J., & Benitez, R. (2022). wavScalogram: an R package with scalogram wavelet tools for time series analysis. The R Journal, 14(2), 164-185.
}
